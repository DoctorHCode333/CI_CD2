inboundCall:
  name: CI_CD_Test_Flow
  description: Test flow for CI CD Demo
  division: Home
  startUpRef: "/inboundCall/tasks/task[New Task 1_12]"
  defaultLanguage: en-us
  supportedLanguages:
    en-us:
      defaultLanguageSkill:
        noValue: true
      textToSpeech:
        defaultEngine:
          defaultVoice: true
    es-us:
      defaultLanguageSkill:
        noValue: true
      textToSpeech:
        defaultEngine:
          voice: es-US-AlonsoNeural
  variables:
    - integerVariable:
        name: Flow.Accno
        initialValue:
          noValue: true
    - stringVariable:
        name: Flow.AgentID
        initialValue:
          noValue: true
    - userVariable:
        name: Flow.AgentName
        initialValue:
          noValue: true
    - stringVariable:
        name: Flow.AgentStatus
        initialValue:
          noValue: true
    - stringVariable:
        name: Flow.CustName
        initialValue:
          noValue: true
    - stringVariable:
        name: Flow.End
        initialValue:
          noValue: true
    - stringVariable:
        name: Flow.PrefLang
        initialValue:
          noValue: true
    - stringVariable:
        name: Flow.Start
        initialValue:
          noValue: true
    - stringVariable:
        name: Flow.Total_duration
        initialValue:
          noValue: true
  settingsActionDefaults:
    playAudioOnSilence:
      timeout:
        lit:
          seconds: 40
    detectSilence:
      timeout:
        lit:
          seconds: 40
    callData:
      processingPrompt:
        noValue: true
    collectInput:
      noEntryTimeout:
        lit:
          seconds: 5
    dialByExtension:
      interDigitTimeout:
        lit:
          seconds: 6
    transferToUser:
      connectTimeout:
        noValue: true
    transferToNumber:
      connectTimeout:
        noValue: true
    transferToGroup:
      connectTimeout:
        noValue: true
    transferToFlowSecure:
      connectTimeout:
        lit:
          seconds: 15
  settingsErrorHandling:
    errorHandling:
      disconnect:
        none: true
    preHandlingAudio:
      tts: Sorry, an error occurred. Please try your call again.
  settingsMenu:
    extensionDialingMaxDelay:
      lit:
        seconds: 1
    listenForExtensionDialing:
      lit: true
    menuSelectionTimeout:
      lit:
        seconds: 10
    repeatCount:
      lit: 3
  settingsPrompts:
    ensureAudioInPrompts: false
    promptMediaToValidate:
      - mediaType: audio
      - mediaType: tts
  settingsSpeechRec:
    completeMatchTimeout:
      lit:
        ms: 100
    incompleteMatchTimeout:
      lit:
        ms: 1500
    maxSpeechLengthTimeout:
      lit:
        seconds: 20
    minConfidenceLevel:
      lit: 50
    asrCompanyDir: none
    asrEnabledOnFlow: true
    suppressRecording: true
  tasks:
    - task:
        name: New Task 1
        refId: New Task 1_12
        actions:
          - callCommonModule:
              name: Call Common Module
              commonModule:
                2445093_Lang:
                  ver_latestPublished:
                    inputs:
                      Common.ani:
                        exp: Call.Ani
                    outputs:
                      Common.Custname:
                        var: Flow.CustName
                      Common.Lang:
                        var: Flow.PrefLang
                      Common.Accno:
                        var: Flow.Accno
          - evaluateScheduleGroup:
              name: Evaluate Schedule Group
              inServiceSchedules:
                noValue: true
              evaluate:
                now: true
              scheduleGroup:
                lit:
                  name: 2445093_SG
                name: 2445093_SG
              emergencyGroup:
                noValue: true
              outputs:
                open:
                  actions:
                    - switch:
                        name: Switch
                        evaluate:
                          firstTrue:
                            default:
                              actions:
                                - playAudio:
                                    name: Play Audio
                                    audio:
                                      tts: This is default flow
                            cases:
                              - case:
                                  value:
                                    exp: Call.CalledAddressOriginal == "+12345679226"
                                  actions:
                                    - playAudio:
                                        name: Play Audio
                                        audio:
                                          alternateSequences:
                                            en-us:
                                              tts: "Your call is being re-routed to our Accounts department "
                                            es-us:
                                              tts: Su llamada está siendo redirigida a nuestro departamento de Cuentas
                                    - jumpToTask:
                                        name: Jump to Reusable Task
                                        targetTaskRef: "/inboundCall/tasks/task[Acc_det_api_69]"
                              - case:
                                  value:
                                    exp: Call.CalledAddressOriginal == "+12345679227"
                                  actions:
                                    - playAudio:
                                        name: Play Audio
                                        audio:
                                          alternateSequences:
                                            en-us:
                                              tts: Your call is being redirected to our Online Banking department
                                            es-us:
                                              tts: Su llamada está siendo redirigida a nuestro departamento de Banca en Línea
                                    - jumpToTask:
                                        name: Jump to Reusable Task
                                        targetTaskRef: "/inboundCall/tasks/task[Online_Banking_Dept_API_85]"
                closed:
                  actions:
                    - transferToVoicemail:
                        name: Transfer to Voicemail
                        destination:
                          queue:
                            targetQueue:
                              lit:
                                name: 2445093_VoiceMail
                            callbackNumber:
                              exp: ToPhoneNumber(Call.Ani)
                            calleeName:
                              noValue: true
                            voicemailGreeting:
                              tts: Welcome to XYZ Bank. We are currently closed. Please leave a voicemail
                        preTransferAudio:
                          tts: Your call is being transferred to Voicemail
                        failureTransferAudio:
                          tts: Failed to transfer call to Voicemail
                        failureOutputs:
                          errorType:
                            noValue: true
                          errorMessage:
                            noValue: true
                        outputs:
                          failure:
                            actions:
                              - playAudio:
                                  name: Play Audio
                                  audio:
                                    tts: failure in closed
                holiday:
                  actions:
                    - transferToVoicemail:
                        name: Transfer to Voicemail
                        destination:
                          queue:
                            targetQueue:
                              lit:
                                name: 2445093_VoiceMail
                            callbackNumber:
                              exp: ToPhoneNumber(Call.Ani)
                            calleeName:
                              noValue: true
                            voicemailGreeting:
                              tts: Welcome to XYZ Bank. We are currently closed. Please leave a voicemail
                        preTransferAudio:
                          tts: Your call is being transferred to Voicemail
                        failureTransferAudio:
                          tts: Failed to transfer call to Voicemail
                        failureOutputs:
                          errorType:
                            noValue: true
                          errorMessage:
                            noValue: true
                        outputs:
                          failure:
                            actions:
                              - playAudio:
                                  name: Play Audio
                                  audio:
                                    tts: failure in holiday
                emergency:
                  actions:
                    - transferToVoicemail:
                        name: Transfer to Voicemail
                        destination:
                          queue:
                            targetQueue:
                              lit:
                                name: 2445093_VoiceMail
                            callbackNumber:
                              exp: ToPhoneNumber(Call.Ani)
                            calleeName:
                              noValue: true
                            voicemailGreeting:
                              tts: Welcome to XYZ Bank. We are currently closed. Please leave a voicemail
                        preTransferAudio:
                          tts: Your call is being transferred to Voicemail
                        failureTransferAudio:
                          tts: Failed to transfer call to Voicemail
                        failureOutputs:
                          errorType:
                            noValue: true
                          errorMessage:
                            noValue: true
                        outputs:
                          failure:
                            actions:
                              - playAudio:
                                  name: Play Audio
                                  audio:
                                    tts: failyure in emergency
          - disconnect:
              name: Disconnect
    - task:
        name: Acc_det_api
        refId: Acc_det_api_69
        actions:
          - updateData:
              name: Update Data
              statements:
                - string:
                    variable: Flow.Start
                    value:
                      exp: ToString(AddHours(GetCurrentDateTimeUtc(),-48))
                - string:
                    variable: Flow.End
                    value:
                      exp: ToString(GetCurrentDateTimeUtc())
          - updateData:
              name: Update Data
              statements:
                - string:
                    variable: Flow.Total_duration
                    value:
                      exp: Flow.Start+"/"+Flow.End
          - callData:
              name: Getting agent ID
              processingPrompt:
                noValueWithNoFallback: true
              timeout:
                lit:
                  minutes: 1
              category:
                "GenC1 Data Actions ":
                  dataAction:
                    2445093:
                      inputs:
                        interval:
                          exp: Flow.Total_duration
                        sip:
                          lit: "sip:6348235772de551c6b20025e+cognizant3.orgspan.com@localhost"
                      successOutputs:
                        agentid:
                          var: Flow.AgentID
              outputs:
                success:
                  actions:
                    - callData:
                        name: Getting agent status
                        processingPrompt:
                          noValue: true
                        timeout:
                          lit:
                            minutes: 1
                        category:
                          "GenC1 Data Actions ":
                            dataAction:
                              2445093_agentstatus:
                                inputs:
                                  agentID:
                                    exp: Flow.AgentID
                                successOutputs:
                                  agent_status:
                                    var: Flow.AgentStatus
                        outputs:
                          success:
                            actions:
                              - decision:
                                  name: Decision
                                  condition:
                                    exp: Flow.AgentStatus == "IDLE"
                                  outputs:
                                    "yes":
                                      actions:
                                        - findUserById:
                                            name: Find Agemt by ID
                                            findId:
                                              exp: Flow.AgentID
                                            findResult:
                                              var: Flow.AgentName
                                            outputs:
                                              found:
                                                actions:
                                                  - setScreenPop:
                                                      name: Set Screen Pop
                                                      screenPopScript:
                                                        2445093_F_Script:
                                                          inputs:
                                                            Customer Name:
                                                              exp: Flow.CustName
                                                            Pref Lang:
                                                              exp: Flow.PrefLang
                                                            Phone number:
                                                              exp: Call.Ani
                                                            Account number:
                                                              exp: Flow.Accno
                                                  - transferToUser:
                                                      name: Transfer to User
                                                      targetUser:
                                                        exp: Flow.AgentName
                                                      allowVoicemailRollover:
                                                        lit: true
                                                      preTransferAudio:
                                                        tts: You are being transferred to the last agent you talked to
                                                        alternateSequences:
                                                          en-us:
                                                            tts: You are being transferred to the last agent you talked to
                                                          es-us:
                                                            tts: Estás siendo transferido al último agente con el que hablaste.
                                                      failureTransferAudio:
                                                        tts: Failed to Transfer
                                                      connectTimeout:
                                                        noValue: true
                                                      failureOutputs:
                                                        errorType:
                                                          noValue: true
                                                        errorMessage:
                                                          noValue: true
                                              notFound:
                                                actions:
                                                  - setScreenPop:
                                                      name: Set Screen Pop
                                                      screenPopScript:
                                                        2445093_F_Script:
                                                          inputs:
                                                            Customer Name:
                                                              exp: Flow.CustName
                                                            Pref Lang:
                                                              exp: Flow.PrefLang
                                                            Phone number:
                                                              exp: Call.Ani
                                                            Account number:
                                                              exp: Flow.Accno
                                                  - transferToAcd:
                                                      name: Transfer to ACD
                                                      targetQueue:
                                                        lit:
                                                          name: 2445093_AccountDets
                                                      preTransferAudio:
                                                        tts: You are being transferred to the Accounts Department queue because your agent was not found.
                                                        alternateSequences:
                                                          en-us:
                                                            tts: You are being transferred to the Accounts Department queue because your agent was not found.
                                                          es-us:
                                                            tts: "Se le está transfiriendo a la cola del Departamento de Cuentas porque no se encontró a su agente.\n"
                                                      failureTransferAudio:
                                                        tts: Failed to Transfer
                                                      priority:
                                                        lit: 0
                                                      preferredAgents:
                                                        noValue: true
                                                      languageSkill:
                                                        noValue: true
                                                      directAgent:
                                                        noValue: true
                                                      failureOutputs:
                                                        errorType:
                                                          noValue: true
                                                        errorMessage:
                                                          noValue: true
                                    "no":
                                      actions:
                                        - playAudio:
                                            name: Play Audio
                                            audio:
                                              alternateSequences:
                                                en-us:
                                                  tts: Your agent is not Idle right now so you are being ransferred to Account department
                                                es-us:
                                                  tts: "Su agente no está disponible en este momento, por lo que está siendo transferido al departamento de cuentas.\n"
                                        - setScreenPop:
                                            name: Set Screen Pop
                                            screenPopScript:
                                              2445093_F_Script:
                                                inputs:
                                                  Customer Name:
                                                    exp: Flow.CustName
                                                  Pref Lang:
                                                    exp: Flow.PrefLang
                                                  Phone number:
                                                    exp: Call.Ani
                                                  Account number:
                                                    exp: Flow.Accno
                                        - transferToAcd:
                                            name: Transfer to ACD
                                            targetQueue:
                                              lit:
                                                name: 2445093_AccountDets
                                            preTransferAudio:
                                              tts: You are being transferred to the Accounts Department queue because your agent was not found.
                                              alternateSequences:
                                                en-us:
                                                  tts: "You are being transferred to the Accounts Department queue "
                                                es-us:
                                                  tts: Estás siendo transferido a la cola del Departamento de Contabilidad.
                                            failureTransferAudio:
                                              tts: Failed to Transfer
                                            priority:
                                              lit: 0
                                            preferredAgents:
                                              noValue: true
                                            languageSkill:
                                              noValue: true
                                            directAgent:
                                              noValue: true
                                            failureOutputs:
                                              errorType:
                                                noValue: true
                                              errorMessage:
                                                noValue: true
                          failure:
                            actions:
                              - playAudio:
                                  name: Play Audio
                                  audio:
                                    tts: Failed to get Agent Status
                failure:
                  actions:
                    - playAudio:
                        name: Play Audio
                        audio:
                          tts: No Agent found in the duration or Failed at finding last agent
                    - setScreenPop:
                        name: Set Screen Pop
                        screenPopScript:
                          2445093_F_Script:
                            inputs:
                              Customer Name:
                                exp: Flow.CustName
                              Pref Lang:
                                exp: Flow.PrefLang
                              Phone number:
                                exp: Call.Ani
                              Account number:
                                exp: Flow.Accno
                    - transferToAcd:
                        name: Transfer to ACD
                        targetQueue:
                          lit:
                            name: 2445093_AccountDets
                        preTransferAudio:
                          alternateSequences:
                            en-us:
                              tts: "Redirecting to Accounts department "
                            es-us:
                              tts: Redirigiendo al departamento de Cuentas
                        failureTransferAudio:
                          tts: Failed to redirect to accounts department. please try later
                        priority:
                          lit: 0
                        preferredAgents:
                          noValue: true
                        languageSkill:
                          noValue: true
                        directAgent:
                          noValue: true
                        failureOutputs:
                          errorType:
                            noValue: true
                          errorMessage:
                            noValue: true
          - disconnect:
              name: Disconnect
    - task:
        name: Online_Banking_Dept_API
        refId: Online_Banking_Dept_API_85
        actions:
          - updateData:
              name: Update Data
              statements:
                - string:
                    variable: Flow.Start
                    value:
                      exp: ToString(AddDays(GetCurrentDateTimeUtc(), -7))
                - string:
                    variable: Flow.End
                    value:
                      exp: ToString(GetCurrentDateTimeUtc())
          - updateData:
              name: Update Data
              statements:
                - string:
                    variable: Flow.Total_duration
                    value:
                      exp: Flow.Start+"/"+Flow.End
          - callData:
              name: Getting agent ID
              processingPrompt:
                noValueWithNoFallback: true
              timeout:
                lit:
                  minutes: 1
              category:
                "GenC1 Data Actions ":
                  dataAction:
                    2445093:
                      inputs:
                        interval:
                          exp: Flow.Total_duration
                        sip:
                          lit: "sip:6348235772de551c6b20025e+cognizant3.orgspan.com@localhost  "
                      successOutputs:
                        agentid:
                          var: Flow.AgentID
              outputs:
                success:
                  actions:
                    - callData:
                        name: Getting agent status
                        processingPrompt:
                          noValue: true
                        timeout:
                          lit:
                            minutes: 1
                        category:
                          "GenC1 Data Actions ":
                            dataAction:
                              2445093_agentstatus:
                                inputs:
                                  agentID:
                                    exp: Flow.AgentID
                                successOutputs:
                                  agent_status:
                                    var: Flow.AgentStatus
                        outputs:
                          success:
                            actions:
                              - decision:
                                  name: Decision
                                  condition:
                                    exp: Flow.AgentStatus == "IDLE"
                                  outputs:
                                    "yes":
                                      actions:
                                        - findUserById:
                                            name: Find Agemt by ID
                                            findId:
                                              exp: Flow.AgentID
                                            findResult:
                                              var: Flow.AgentName
                                            outputs:
                                              found:
                                                actions:
                                                  - setScreenPop:
                                                      name: Set Screen Pop
                                                      screenPopScript:
                                                        2445093_F_Script:
                                                          inputs:
                                                            Customer Name:
                                                              exp: Flow.CustName
                                                            Pref Lang:
                                                              exp: Flow.PrefLang
                                                            Phone number:
                                                              exp: Call.Ani
                                                            Account number:
                                                              exp: Flow.Accno
                                                  - transferToUser:
                                                      name: Transfer to User
                                                      targetUser:
                                                        exp: Flow.AgentName
                                                      allowVoicemailRollover:
                                                        lit: true
                                                      preTransferAudio:
                                                        tts: You are being transferred to the last agent you talked to
                                                        alternateSequences:
                                                          en-us:
                                                            tts: You are being transferred to the last agent you talked to
                                                          es-us:
                                                            tts: Estás siendo transferido al último agente con el que hablaste.
                                                      failureTransferAudio:
                                                        tts: Failed to Transfer
                                                      connectTimeout:
                                                        noValue: true
                                                      failureOutputs:
                                                        errorType:
                                                          noValue: true
                                                        errorMessage:
                                                          noValue: true
                                              notFound:
                                                actions:
                                                  - setScreenPop:
                                                      name: Set Screen Pop
                                                      screenPopScript:
                                                        2445093_F_Script:
                                                          inputs:
                                                            Customer Name:
                                                              exp: Flow.CustName
                                                            Pref Lang:
                                                              exp: Flow.PrefLang
                                                            Phone number:
                                                              exp: Call.Ani
                                                            Account number:
                                                              exp: Flow.Accno
                                                  - transferToAcd:
                                                      name: Transfer to ACD
                                                      targetQueue:
                                                        lit:
                                                          name: 2445093_OnlineBanking
                                                      preTransferAudio:
                                                        tts: You are being transferred to the Online Banking Department queue because your agent was not found.
                                                        alternateSequences:
                                                          en-us:
                                                            tts: You are being transferred to the Accounts Department queue because your agent was not found.
                                                          es-us:
                                                            tts: Se le está transfiriendo a la cola del Departamento de Banca en Línea porque no se encontró a su agente.
                                                      failureTransferAudio:
                                                        tts: Failed to Transfer
                                                      priority:
                                                        lit: 0
                                                      preferredAgents:
                                                        noValue: true
                                                      languageSkill:
                                                        noValue: true
                                                      directAgent:
                                                        noValue: true
                                                      failureOutputs:
                                                        errorType:
                                                          noValue: true
                                                        errorMessage:
                                                          noValue: true
                                    "no":
                                      actions:
                                        - playAudio:
                                            name: Play Audio
                                            audio:
                                              alternateSequences:
                                                en-us:
                                                  tts: Your agent is not Idle right now so you are being transferred to Online Banking department
                                                es-us:
                                                  tts: Su agente no está disponible en este momento, por lo que está siendo transferido al departamento de Banca en Línea.
                                        - setScreenPop:
                                            name: Set Screen Pop
                                            screenPopScript:
                                              2445093_F_Script:
                                                inputs:
                                                  Customer Name:
                                                    exp: Flow.CustName
                                                  Pref Lang:
                                                    exp: Flow.PrefLang
                                                  Phone number:
                                                    exp: Call.Ani
                                                  Account number:
                                                    exp: Flow.Accno
                                        - transferToAcd:
                                            name: Transfer to ACD
                                            targetQueue:
                                              lit:
                                                name: 2445093_OnlineBanking
                                            preTransferAudio:
                                              alternateSequences:
                                                en-us:
                                                  tts: You are being transferred to the Online Banking Department queue because your agent was not found.
                                                es-us:
                                                  tts: You are being transferred to the Online Banking Department queue because your agent was not found.
                                            failureTransferAudio:
                                              tts: Failed to Transfer
                                            priority:
                                              lit: 0
                                            preferredAgents:
                                              noValue: true
                                            languageSkill:
                                              noValue: true
                                            directAgent:
                                              noValue: true
                                            failureOutputs:
                                              errorType:
                                                noValue: true
                                              errorMessage:
                                                noValue: true
                          failure:
                            actions:
                              - playAudio:
                                  name: Play Audio
                                  audio:
                                    tts: Failed to get Agent Status
                failure:
                  actions:
                    - playAudio:
                        name: Play Audio
                        audio:
                          tts: No Agent found in the duration or Failed at finding last agent
                    - setScreenPop:
                        name: Set Screen Pop
                        screenPopScript:
                          2445093_F_Script:
                            inputs:
                              Customer Name:
                                exp: Flow.CustName
                              Pref Lang:
                                exp: Flow.PrefLang
                              Phone number:
                                exp: Call.Ani
                              Account number:
                                exp: Flow.Accno
                    - transferToAcd:
                        name: Transfer to ACD
                        targetQueue:
                          lit:
                            name: 2445093_OnlineBanking
                        preTransferAudio:
                          alternateSequences:
                            en-us:
                              tts: Redirecting You to Online Banking department
                            es-us:
                              tts: Redirigiéndote al departamento de Banca en Línea
                        failureTransferAudio:
                          tts: Failed to redirect to Online Banking department. Please try again later
                        priority:
                          lit: 0
                        preferredAgents:
                          noValue: true
                        languageSkill:
                          noValue: true
                        directAgent:
                          noValue: true
                        failureOutputs:
                          errorType:
                            noValue: true
                          errorMessage:
                            noValue: true
                        outputs:
                          failure:
                            actions:
                              - disconnect:
                                  name: Disconnect
          - disconnect:
              name: Disconnect
